<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Valorant ランダムピック</title>
<style>
  :root{
    --bg:#0b1014;
    --card:#0f1720;
    --accent:#ff4655;
    --muted:#9aa4ad;
    --glass: rgba(255,255,255,0.03);
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", "Noto Sans JP", "Yu Gothic UI", "Hiragino Kaku Gothic ProN", "Meiryo", sans-serif;
  }
  html,body{height:100%; margin:0; background:linear-gradient(180deg,#071018 0%, #08131a 100%); color:#e6eef6}
  .wrap{max-width:920px;margin:40px auto;padding:28px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;box-shadow:0 6px 30px rgba(0,0,0,0.6);}
  header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
  h1{font-size:20px;margin:0}
  .controls{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:18px;align-items:center}
  .control-group{display:flex;gap:8px;align-items:center}
  label{font-size:13px;color:var(--muted)}
  select,input[type=number]{background:var(--card);border:1px solid rgba(255,255,255,0.04);padding:8px;border-radius:8px;color:inherit}
  button{background:var(--accent);color:white;border:none;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600}
  button.alt{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
  .result-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:12px;margin-top:18px}
  .slot{background:var(--glass);border-radius:10px;padding:12px;min-height:110px;display:flex;flex-direction:column;align-items:center;justify-content:center; text-align:center; transition: transform .35s cubic-bezier(.2,.9,.3,1), box-shadow .2s}
  .slot.flash{transform:translateY(-8px) scale(1.02); box-shadow:0 14px 40px rgba(0,0,0,0.6)}
  .agent-name{font-weight:700;margin-top:8px}
  .agent-role{font-size:12px;color:var(--muted);margin-top:4px}
  .agent-img{width:64px;height:64px;border-radius:8px;background:linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));display:flex;align-items:center;justify-content:center;overflow:hidden}
  .small{font-size:12px;color:var(--muted)}
  .footer{display:flex;justify-content:space-between;align-items:center;margin-top:18px;gap:12px;flex-wrap:wrap}
  .settings{display:flex;gap:8px;align-items:center}
  .agents-editor{margin-top:18px;background:rgba(255,255,255,0.02);padding:12px;border-radius:10px}
  textarea{width:100%;min-height:120px;background:#07121a;border:1px solid rgba(255,255,255,0.03);color:#cfe7ff;padding:10px;border-radius:8px;font-family:monospace;font-size:13px}
  .hint{font-size:12px;color:var(--muted);margin-top:6px}
  @media (max-width:880px){
    .result-grid{grid-template-columns:repeat(2,1fr)}
  }
</style>
</head>
<body>
<div class="wrap" role="application" aria-label="Valorant ランダムピック">
  <header>
    <img src="" alt="" id="logo" style="width:44px;height:44px;border-radius:8px;background:linear-gradient(45deg,#ff4655,#7b61ff)">
    <div>
      <h1>Valorant ランダムピック</h1>
      <div class="small">スペースキーでもピックできます — リストは下で編集可能</div>
    </div>
  </header>

  <div class="controls" role="region" aria-label="操作">
    <div class="control-group">
      <label for="num">ピック数</label>
      <select id="num" title="選ぶ枠数">
        <option value="1">1</option>
        <option value="2" selected>2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
      </select>
    </div>

    <div class="control-group">
      <label for="allowDup">重複を許可</label>
      <input type="checkbox" id="allowDup" />
    </div>

    <div class="control-group">
      <label for="roleFilter">ロールで絞る</label>
      <select id="roleFilter">
        <option value="all">すべて</option>
        <option value="Duelist">Duelist</option>
        <option value="Initiator">Initiator</option>
        <option value="Controller">Controller</option>
        <option value="Sentinel">Sentinel</option>
      </select>
    </div>

    <div style="margin-left:auto;display:flex;gap:8px">
      <button id="pickBtn">ランダムピック</button>
      <button id="copyBtn" class="alt">結果をコピー</button>
    </div>
  </div>

  <main>
    <div id="description" class="small">枠を選んで「ランダムピック」を押すかスペースキーを押すとピックされます。</div>

    <div class="result-grid" id="resultGrid" aria-live="polite">
      <!-- ここにスロットが入る -->
    </div>

    <div class="footer">
      <div class="small">© Valorant Random Picker — リストは下で編集</div>
      <div class="settings small">ショートカット: <strong>Space</strong> = ピック</div>
    </div>

    <section class="agents-editor" aria-label="エージェント編集">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px">
        <strong>エージェントリスト（JSON形式）</strong>
        <div class="small">各エージェントは <code>{ "name": "...", "role": "Duelist", "img": "path/or/url" }</code> の形</div>
      </div>
      <textarea id="agentsArea" spellcheck="false"></textarea>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="loadDefault">デフォルト読み込み</button>
        <button id="applyList" class="alt">リスト反映</button>
      </div>
      <div class="hint">※ 画像は相対パスか外部URLを入れてください。画像がないとアイコンの代わりに名前イニシャルが表示されます。</div>
    </section>
  </main>
</div>

<script>
/* ======= 編集可能エージェント（デフォルト） =======
   必要ならここを編集／追加してから「デフォルト読み込み」や
   textareaの内容を変えて「リスト反映」を押してください。
   img フィールドは省略可能。 */
const defaultAgents = [
  {name:"Jett", role:"Duelist", img:"https://th.bing.com/th/id/OIP.Y5GfKw_gi6k4F3N4yqWZpQHaEK?w=315&h=180&c=7&r=0&o=7&cb=ucfimg2&pid=1.7&rm=3&ucfimg=1"},
  {name:"Phoenix", role:"Duelist", img:"https://th.bing.com/th/id/OIP.R8JVlfjvh0D29_fpy0NBIgHaEK?w=298&h=180&c=7&r=0&o=7&cb=ucfimg2&pid=1.7&rm=3&ucfimg=1"},
  {name:"Reyna", role:"Duelist", img:"data:image/webp;base64,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"},
  {name:"Neon", role:"Duelist", img:"https://th.bing.com/th/id/OIP.ylkvs0D9mOQUzj_dYmHaiwHaE8?w=272&h=181&c=7&r=0&o=7&cb=ucfimg2&pid=1.7&rm=3&ucfimg=1"},
  {name:"Raze", role:"Duelist", img:"https://th.bing.com/th/id/OIP.hrb169bKSqvpOV9qj2UkwAHaEK?w=326&h=183&c=7&r=0&o=7&cb=ucfimg2&pid=1.7&rm=3&ucfimg=1"},
  {name:"Sage", role:"Sentinel", img:""},
  {name:"Cypher", role:"Sentinel", img:""},
  {name:"Killjoy", role:"Sentinel", img:""},
  {name:"Skye", role:"Initiator", img:""},
  {name:"Sova", role:"Initiator", img:""},
  {name:"Breach", role:"Initiator", img:""},
  {name:"Fade", role:"Initiator", img:""},
  {name:"Viper", role:"Controller", img:"https://wallpapercave.com/wp/wp6012322.jpg"},
  {name:"Omen", role:"Controller", img:""},
  {name:"Astra", role:"Controller", img:""},
  {name:"Brimstone", role:"Controller", img:""}
];

let agents = [...defaultAgents];

const resultGrid = document.getElementById('resultGrid');
const pickBtn = document.getElementById('pickBtn');
const copyBtn = document.getElementById('copyBtn');
const numSelect = document.getElementById('num');
const allowDup = document.getElementById('allowDup');
const roleFilter = document.getElementById('roleFilter');
const agentsArea = document.getElementById('agentsArea');
const loadDefault = document.getElementById('loadDefault');
const applyList = document.getElementById('applyList');

function init(){
  // テキストエリアに初期JSONを入れておく
  agentsArea.value = JSON.stringify(agents, null, 2);
  renderSlots(Number(numSelect.value));
}
function renderSlots(n){
  resultGrid.innerHTML = '';
  for(let i=0;i<n;i++){
    const div = document.createElement('div');
    div.className = 'slot';
    div.dataset.index = i;
    div.innerHTML = `<div class="agent-img" aria-hidden="true"><span class="initial"></span></div>
                     <div class="agent-name">--</div>
                     <div class="agent-role"></div>`;
    resultGrid.appendChild(div);
  }
}

function pickRandom(){
  const count = Number(numSelect.value);
  const allowRepeat = allowDup.checked;
  const role = roleFilter.value;
  let pool = agents.slice();
  if(role !== 'all'){
    pool = pool.filter(a=>a.role === role);
  }
  if(pool.length === 0){
    alert('選択されたロールにエージェントがいません。エージェントリストを確認してください。');
    return;
  }

  const picks = [];
  if(allowRepeat){
    for(let i=0;i<count;i++){
      const r = pool[Math.floor(Math.random()*pool.length)];
      picks.push(r);
    }
  } else {
    // 重複なし（poolがcount未満ならシャッフルして不足分はランダムで補う）
    const shuffled = pool.slice().sort(()=>Math.random()-0.5);
    for(let i=0;i<count;i++){
      if(i < shuffled.length){
        picks.push(shuffled[i]);
      } else {
        // 全員取り切ったら残りはランダム（同じものが出る可能性あり）
        picks.push(pool[Math.floor(Math.random()*pool.length)]);
      }
    }
  }
  showPicks(picks);
}

function showPicks(picks){
  const slots = Array.from(resultGrid.children);
  // アニメーションで順に表示
  slots.forEach((slot, i)=>{
    const agent = picks[i] || null;
    if(!agent){
      slot.querySelector('.agent-name').textContent = '--';
      slot.querySelector('.agent-role').textContent = '';
      slot.querySelector('.initial').textContent = '';
      slot.querySelector('.agent-img').style.backgroundImage = '';
      return;
    }
    // small 'reveal' animation
    slot.classList.remove('flash');
    setTimeout(()=>slot.classList.add('flash'), 50 + i*80);
    slot.querySelector('.agent-name').textContent = agent.name;
    slot.querySelector('.agent-role').textContent = agent.role || '';
    const imgWrap = slot.querySelector('.agent-img');
    const initial = slot.querySelector('.initial');
    if(agent.img){
      // 画像があれば背景表示
      imgWrap.style.backgroundImage = `url("${agent.img}")`;
      imgWrap.style.backgroundSize = 'cover';
      imgWrap.style.backgroundPosition = 'center';
      initial.textContent = '';
    } else {
      imgWrap.style.backgroundImage = '';
      const initials = agent.name.split(' ').map(s=>s[0]).slice(0,2).join('').toUpperCase();
      initial.textContent = initials;
    }
  });
}

function copyResult(){
  const names = Array.from(resultGrid.children).map(s => s.querySelector('.agent-name').textContent).filter(Boolean);
  if(names.length === 0) { alert('結果がありません'); return; }
  const text = `Valorant ランダムピック: ${names.join(' / ')}`;
  navigator.clipboard?.writeText(text).then(()=>{
    alert('結果をコピーしました:\n' + text);
  }).catch(()=>{
    prompt('コピーに失敗しました。以下を手動でコピーしてください', text);
  });
}

// JSONをパースしてリスト反映
function applyAgentsFromTextarea(){
  try{
    const parsed = JSON.parse(agentsArea.value);
    if(!Array.isArray(parsed)) throw new Error('配列ではありません');
    // 最低限 name があるかチェック
    for(const a of parsed){
      if(!a.name) throw new Error('各オブジェクトに name が必要です');
      if(!a.role) a.role = 'Duelist';
    }
    agents = parsed;
    alert('エージェントリストを更新しました (' + agents.length + ' 件)');
  }catch(e){
    alert('JSON 解析エラー: ' + e.message);
  }
}

// イベント
pickBtn.addEventListener('click', pickRandom);
copyBtn.addEventListener('click', copyResult);
numSelect.addEventListener('change', ()=>renderSlots(Number(numSelect.value)));
loadDefault.addEventListener('click', ()=>{
  agents = [...defaultAgents];
  agentsArea.value = JSON.stringify(agents, null, 2);
  alert('デフォルトリストを読み込みました');
});
applyList.addEventListener('click', applyAgentsFromTextarea);

// スペースキーでピック
document.addEventListener('keydown', (e)=>{
  if(e.code === 'Space' && !/input|textarea/i.test(document.activeElement.tagName)){
    e.preventDefault();
    pickRandom();
  }
});

// 初期描画
init();
</script>
</body>
</html>
